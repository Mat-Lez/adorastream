<h1 class="page-title">Manage Profiles</h1>

<div class="profiles-list">
    <% if (typeof profiles !== 'undefined' && profiles.length) { %>
    <% profiles.forEach(function(p) { %>
        
        <a id="<%= p._id %>" class="profile-box">
        
        <div class="profile-box-avatar">
            <% if (p.avatarPath) { %>
            <img
                src="/assets/<%= p.avatarPath %>?v=<%= Date.now() %>"
                alt="<%= p.name %>'s avatar"
                onerror="this.onerror=null; this.style.display='none'; this.nextElementSibling.style.display='flex';"
            />
            <div class="profile-avatar-emoji" style="display: none;">ðŸ‘¤</div>
            <% } else { %>
            <div class="profile-avatar-emoji">ðŸ‘¤</div>
            <% } %>
        </div>

        <!-- Profile Name -->
        <span class="profile-box-name"><%= p.name %></span>

        <!-- "Your Profile" Tag -->
        <% if (String(p._id) === String(activeProfileId)) { %>
            <span class="profile-box-tag">Your Profile</span>
        <% } %>

        <!-- Chevron Icon -->
        <i class="bi bi-chevron-right profile-box-chevron"></i>
        </a>

    <% }) %>
    <% } else { %>
    <p class="profiles-empty-state">No profiles found.</p>
    <% } %>
</div>

<% if (typeof profiles !== 'undefined' && profiles.length < 5) { %>
    <!-- "Add Profile" Button -->
    <a class="add-profile-box">
        <i class="bi bi-plus-lg"></i>
        <span>Add Profile</span>
    </a>

    <p class="profiles-page-subtitle">
        Add up to 5 profiles for anyone who lives with you.
    </p>
<% } %>