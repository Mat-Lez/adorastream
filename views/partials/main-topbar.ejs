<% 
  // ----------------------------
  // CONFIGURATION
  // ----------------------------
  const availableTopbarParts = {
    search: "SEARCH",
    filters: "FILTERS",
    topbarActions: "TOPBAR_ACTIONS"
  };

    const availableTopbarActions = {
      logoutButton: "LOGOUT_BUTTON",
      profileDropdown: "PROFILE_DROPDOWN",
      addContentButton: "ADD_CONTENT_BUTTON"
    };

  const topbarPartsOrder = [
    availableTopbarParts.search,
    availableTopbarParts.filters,
    availableTopbarParts.topbarActions
  ];

  // Determine which topbar sections to render
  let topbarPartsToDisplay = [];
  if (topbarLayout && topbarLayout.length) {
    topbarPartsToDisplay = topbarPartsOrder.filter(item => topbarLayout.includes(item));
  }

  // Determine which actions appear inside topbar-actions
  let topbarActionsToDisplay = [];
  if (topbarActionsLayout && topbarActionsLayout.length) {
    topbarActionsToDisplay = Object.values(availableTopbarActions).filter(a => topbarActionsLayout.includes(a));
  }

    // ----------------------------
    // RENDERING
    // ----------------------------
    topbarPartsToDisplay.forEach((part) => {
      if (part === availableTopbarParts.search) {
  %>
        <%- include('main-topbar-search.ejs') %>
  <% 
      } else if (part === availableTopbarParts.filters) {
  %>
        <%- include('main-topbar-genre-filter') %>
  <%
      } else if (part === availableTopbarParts.topbarActions) {
  %>
        <div class="topbar-actions">
          <% topbarActionsToDisplay.forEach((action) => { %>
            <% if (action === availableTopbarActions.logoutButton) { %>
              <%- include('main-topbar-logout.ejs') %>
            <% } else if (action === availableTopbarActions.profileDropdown) { %>
              <%- include('main-topbar-profiles-dropdown.ejs') %>
            <% } else if (action === availableTopbarActions.addContentButton && user && user.isAdmin) { %>
              <%- include('main-topbar-add-content.ejs') %>
            <% } %>
          <% }) %>
        </div>
  <% 
      }
    });
  %>
</header>
